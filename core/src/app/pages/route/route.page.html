<ion-menu side="end" menuId="optionMenu" contentId="webmapp-pageroute-main">
  <ion-header>
    <ion-toolbar>
      <ion-buttons slot="start">
        <ion-icon
          name="close-outline"
          class="webmapp-pageroute-menuclose"
          (click)="closeMenu()"
        ></ion-icon>
      </ion-buttons>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item>
        <i class="webmapp-icon-directions-outline" start></i>
        <div class="webmapp-pageroute-menuitem">{{'pages.route.directions' | wmtrans}}</div>
      </ion-item>
      <ion-item (click)="download()">
        <i class="webmapp-icon-donwload-outline" start></i>
        <div class="webmapp-pageroute-menuitem">{{'pages.route.download' | wmtrans}}</div>
      </ion-item>
      <ion-item (click)="share()">
        <i class="webmapp-icon-share-outline"></i>
        <div class="webmapp-pageroute-menuitem">{{'pages.route.share' | wmtrans}}</div>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<ion-content scrollY="false" class="webmapp-pageroute-content" id="webmapp-pageroute-main">
  <div #header class="webmapp-pageroute-header">
    <ion-header
      class="webmapp-pageroute-header"
      [ngClass]="{'webmapp-pageroute-header-hide':modeFullMap}"
    >
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-back-button
            mode="ios"
            defaultHref="map"
            text=""
            class="webmapp-backbutton webmapp-backbutton-dark"
          >
          </ion-back-button>
        </ion-buttons>
        <ion-title>{{route?.properties?.name | wmtrans}}</ion-title>
        <ion-buttons slot="end">
          <ion-icon
            name="ellipsis-vertical"
            class="webmapp-pageroute-menuopen"
            (click)="menu()"
          ></ion-icon>
        </ion-buttons>
      </ion-toolbar>
      <div class="webmapp-pageroute-header-backdrop" [hidden]="opacity>0.5"></div>
      <!-- <ion-toolbar>
        <ion-grid>
          <ion-row>
            <ion-col size="4">
              <i
                class="
                  webmapp-icon-difficulty-high
                  primary
                  webmapp-pageroute-infopanel-icon
                "
              ></i>
              <ion-label class="webmapp-pageroute-infopanel-value"
                >{{route?.properties?.difficulty | wmtrans}}
              </ion-label>
            </ion-col>
            <ion-col size="4">
              <i
                class="
                  webmapp-icon-distance
                  primary
                  webmapp-pageroute-infopanel-icon
                "
              ></i>
              <ion-label class="webmapp-pageroute-infopanel-value">
                {{route?.properties?.distance}} km
              </ion-label>
            </ion-col>
            <ion-col size="4">
              <i
                class="
                  webmapp-icon-duration
                  primary
                  webmapp-pageroute-infopanel-icon
                "
              ></i>
              <ion-label class="webmapp-pageroute-infopanel-value"
                >{{route?.properties?.duration_forward | minutetime}}
              </ion-label>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-toolbar> -->
    </ion-header>
  </div>

  <div #mapcontainer class="webmapp-pageroute-map-container">
    <old-webmapp-map
      class=""
      #map
      [static]="false"
      [animation]="useAnimation"
      [track]="track"
      [hideRegister]="true"
      [hidePosition]="true"
      [btnposition]="'middle'"
      [pois]="pois"
      (clickpoi)="clickPoi($event)"
      [height]="mapHeigth()"
      [slopeChartElements]="slopeChartHoverElements"
      [cache]="useCache"
      (rotate)="mapRotation($event)"
    ></old-webmapp-map>
  </div>

  <div
    class="webmapp-pageroute-infopanel"
    #dragHandleContainer
    [ngClass]="{'webmapp-pageroute-infopanel-hide':modeFullMap}"
    [ngStyle]="{
      'bottom': (minInfoheight-maxInfoheight) + 'px'
    }"
  >
    <ion-card
      class="webmapp-pageroute-infopanel-card"
      [ngStyle]="{
        'height': maxInfoheight + 'px'
      }"
    >
      <div class="webmapp-pageroute-infopanel-drag" #dragHandleIcon (click)="handleClick()">
        <div class="webmapp-pageroute-infopanel-drag-handle"></div>
        <div #lessdetails class="webmapp-pageroute-infopanel-lessdetails">
          <ion-label class="webmapp-pageroute-infopanel-name">
            {{route?.properties?.name | wmtrans}}
          </ion-label>

          <!-- <ion-grid >
            <ion-row>
              <ion-col size="4">
                <i
                  class="
                    webmapp-icon-difficulty-high
                    primary
                    webmapp-pageroute-infopanel-icon
                  "
                ></i>
                <ion-label class="webmapp-pageroute-infopanel-value"
                  >{{route?.properties?.difficulty | wmtrans}}
                </ion-label>
              </ion-col>
              <ion-col size="4">
                <i
                  class="
                    webmapp-icon-distance
                    primary
                    webmapp-pageroute-infopanel-icon
                  "
                ></i>
                <ion-label class="webmapp-pageroute-infopanel-value"
                  >{{route?.properties?.distance}}km
                </ion-label>
              </ion-col>
              <ion-col size="4">
                <i
                  class="
                    webmapp-icon-duration
                    primary
                    webmapp-pageroute-infopanel-icon
                  "
                ></i>
                <ion-label class="webmapp-pageroute-infopanel-value"
                  >{{route?.properties?.duration_forward | minutetime}}
                </ion-label>
              </ion-col>
            </ion-row>
          </ion-grid> -->
        </div>
      </div>
      <ion-content #moredetails scrollY="true" scroll-events="true" (ionScroll)="scroll($event)">
        <webmapp-tab-detail class="webmapp-route-tab"></webmapp-tab-detail>
        <webmapp-tab-description class="webmapp-route-tab"></webmapp-tab-description>
        <webmapp-tab-eat class="webmapp-route-tab"></webmapp-tab-eat>
        <webmapp-tab-howto class="webmapp-route-tab"></webmapp-tab-howto>
        <webmapp-tab-viability class="webmapp-route-tab"></webmapp-tab-viability>
        <webmapp-tab-walkable class="webmapp-route-tab"></webmapp-tab-walkable>
        <!-- <ion-tabs #routeTabs *ngIf="opacity < 0.95" class="webmapp-route-tabs">
          <ion-tab-bar slot="top" class="webmapp-pageroute-infopanel-tabs">
            <ion-slides pager="false" [options]="slideOpts" #slideTab>
              <ion-slide>
                <ion-tab-button
                  tab="route-detail"
                  [routerLink]="['/route/route-detail']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabdetail' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
              <ion-slide>
                <ion-tab-button
                  tab="route-viability"
                  [routerLink]="['/route/route-viability']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabviability' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
              <ion-slide>
                <ion-tab-button
                  tab="route-howto"
                  [routerLink]="['/route/route-howto']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabhowto' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
              <ion-slide>
                <ion-tab-button
                  tab="route-eat"
                  [routerLink]="['/route/route-eat']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabeat' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
              <ion-slide>
                <ion-tab-button
                  tab="route-description"
                  [routerLink]="['/route/route-description']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabdescription' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
              <ion-slide>
                <ion-tab-button
                  tab="route-walkable"
                  [routerLink]="['/route/route-walkable']"
                  class="webmapp-pageroute-infopanel-tabs-button"
                >
                  <ion-label class="webmapp-pageroute-infopanel-tabs-label">
                    {{'pages.route.tabwalkable' | wmtrans}}
                  </ion-label>
                </ion-tab-button>
              </ion-slide>
            </ion-slides>
          </ion-tab-bar>
        </ion-tabs> -->
      </ion-content>
    </ion-card>
  </div>

  <div class="webmapp-pageroute-downloadbackpanel" [hidden]="!showDownload"></div>
  <div class="webmapp-pageroute-downloadpanel" [hidden]="!showDownload">
    <div class="webmapp-pageroute-downloadpanel-container">
      <ion-img
        class="webmapp-pageroute-downloadpanel-logo"
        src="assets/images/logo46.png"
      ></ion-img>
      <i
        class="webmapp-pageroute-downloadpanel-exit webmapp-icon-close-outline"
        (click)="endDownload(true)"
      >
      </i>
      <webmapp-download-panel
        (changeStatus)="downloadStatus($event)"
        (exit)="endDownload()"
      ></webmapp-download-panel>
    </div>
  </div>

  <ion-fab
    [vertical]="'top'"
    horizontal="end"
    class="webmapp-pageroute-fabbottom webmapp-pageroute-fabbottom-top"
    [ngClass]="{'webmapp-pageroute-fabbottom-top-fullmap':modeFullMap}"
  >
    <!-- <ion-fab-button (click)="favourite()" size="small" class="webmapp-pageroute-btnbottom">
      <i [ngClass]="{'webmapp-icon-heart-outline':!isFavourite,'webmapp-icon-heart':isFavourite}"></i>
    </ion-fab-button> -->

    <webmapp-btn-orientation
      class="webmapp-pageroute-btnorient"
      [degrees]="mapDegrees"
      (click)="orientNorth()"
      [hidden]="opacity < 0.5"
    >
    </webmapp-btn-orientation>
    <!--
    <webmapp-btn-register
      class="webmapp-pageroute-btnbottomregister webmapp-pageroute-btnbottom"
    ></webmapp-btn-register>

    <ion-fab-button
      (click)="download()"
      size="small"
      class="webmapp-pageroute-btnbottom"
    >
      <i class="webmapp-icon-donwload-outline"></i>
    </ion-fab-button>
    <webmapp-fav-btn
      (click)="favourite()"
      [isFavourite]="isFavourite"
    ></webmapp-fav-btn>
    <ion-fab-button
      (click)="share()"
      size="small"
      class="webmapp-pageroute-btnbottom"
    >
      <i class="webmapp-icon-share-outline"></i>
    </ion-fab-button>
    <ion-fab-button
      (click)="navigate()"
      size="small"
      class="webmapp-pageroute-btnnavigate"
      *ngIf="opacity <1"
      [ngStyle]="{      'opacity': 1-opacity    }"
    >
      <i class="webmapp-icon-nav-outline"></i>
    </ion-fab-button>-->
  </ion-fab>
  <!-- <ion-button
    (click)="navigate()"
    class="webmapp-pageroute-btnnavigate webmapp-pageroute-btnnavbottom"
    *ngIf="opacity > 0"
    [ngStyle]="{      'opacity': opacity    }"
  >
    <i class="webmapp-icon-nav-outline"></i>
    <ion-label class="webmapp-pageroute-navigatelbl"
      >{{'pages.route.navigate' | wmtrans}}
    </ion-label>
  </ion-button>  -->

  <ion-fab vertical="top" horizontal="end" [ngStyle]="{      'opacity': opacity    }" *ngIf="false">
    <ion-fab-button (click)="menu()" size="small" class="webmapp-pageroute-btntop">
      <i class="webmapp-icon-kebab"></i>
    </ion-fab-button>
  </ion-fab>

  <ion-fab
    vertical="top"
    horizontal="start"
    [ngStyle]="{      'opacity': opacity    }"
    *ngIf="false"
  >
    <ion-fab-button (click)="back()" size="small" class="webmapp-pageroute-btntop">
      <i class="webmapp-icon-chevron-left-outline"></i>
    </ion-fab-button>
  </ion-fab>

  <div
    class="webmapp-pageroute-toolbox"
    [ngClass]="
    {'webmapp-pageroute-toolbox-over':showToolBarOver && opacity < 0.9,
    'webmapp-pageroute-toolbox-hide':opacity < 0.9,
    'webmapp-pageroute-toolbox-hideover':hideToolBarOver,
    'webmapp-pageroute-toolbox-fullmap':modeFullMap}"
  >
    <div (click)="download()" class="webmapp-pageroute-toolbox-button ion-activatable">
      <i class="webmapp-icon-donwload-outline"></i>
      {{ 'pages.route.btndownload' | wmtrans }}
      <ion-ripple-effect></ion-ripple-effect>
    </div>

    <div (click)="share()" class="webmapp-pageroute-toolbox-button ion-activatable">
      <i class="webmapp-icon-share-outline"></i>
      {{ 'pages.route.btnshare' | wmtrans }}
      <ion-ripple-effect></ion-ripple-effect>
    </div>

    <div (click)="navigate()" class="webmapp-pageroute-toolbox-button ion-activatable">
      <i class="webmapp-icon-nav-outline"></i>
      {{ 'pages.route.btndnavigate' | wmtrans }}
      <ion-ripple-effect></ion-ripple-effect>
    </div>

    <div (click)="favourite()" class="webmapp-pageroute-toolbox-button ion-activatable">
      <i *ngIf="isFavourite" class="webmapp-icon-heart"></i>
      <i *ngIf="!isFavourite" class="webmapp-icon-heart-outline"></i>
      {{ 'pages.route.btnfavourite' | wmtrans }}
      <ion-ripple-effect></ion-ripple-effect>
    </div>
  </div>

  <ion-button
    class="webmapp-pageroute-btnfullmap"
    [hidden]="opacity < 0.5"
    [ngClass]="{'webmapp-pageroute-btnfullmap-full':modeFullMap}"
    (click)="toogleFullMap()"
  >
    <div [hidden]="!modeFullMap">
      <ion-icon name="close-outline"></ion-icon>
      {{ 'pages.route.btnFullMapReduce' | wmtrans }}
    </div>
    <div [hidden]="modeFullMap">
      <ion-icon name="resize-outline"></ion-icon>
      {{ 'pages.route.btnFullMapExpand' | wmtrans }}
    </div>
  </ion-button>
</ion-content>
